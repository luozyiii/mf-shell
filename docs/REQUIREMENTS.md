# 云平台微前端系统需求文档

## 📋 项目概述

基于微前端架构的云平台系统，包含主应用、营销系统、财务系统和模板系统，实现统一认证、权限管理和独立部署。

## 🎯 核心目标

- **统一认证**: 集中式用户登录和权限管理
- **动态导航**: 基于权限的动态菜单生成
- **独立开发**: 各子系统独立开发和部署
- **无缝集成**: 主应用统一加载和管理子应用

## 🏗️ 技术要求

- **前端框架**: React 18 + TypeScript
- **微前端**: Module Federation (Rsbuild)
- **UI组件**: Ant Design
- **路由**: React Router v6
- **认证**: JWT Token
- **构建工具**: Rsbuild

## 📁 应用架构

### 主应用 (mf-shell:3000)

- **用户认证**: 登录页面和JWT认证
- **权限管理**: 基于角色的访问控制
- **应用仪表板**: 系统概览和快速入口
- **动态导航**: 基于权限的菜单生成
- **子应用容器**: 微前端应用加载和管理

### 营销系统 (mf-marketing:3001)

- **营销概览**: 数据概览和关键指标
- **活动管理**: 营销活动创建、编辑和管理
- **客户管理**: 客户信息和分群分析
- **数据分析**: 营销数据可视化和ROI分析

### 财务系统 (mf-finance:3002)

- **财务概览**: 财务数据和趋势分析
- **财务报表**: 收入、支出、资产负债表
- **账务管理**: 银行账户和资金管理
- **成本分析**: 成本结构分析和优化

### 模板系统 (mf-template:3003)

- **模板展示**: 标准微前端应用模板
- **功能演示**: 完整的页面和组件示例
- **开发参考**: 新子系统开发规范参考
- **快速创建**: 新子系统创建模板
- **自动化脚本**: 一键生成配置
- **统一规范**: 标准化开发模式

## 🔐 认证与权限

### 用户认证

- **登录方式**: 用户名密码登录
- **认证机制**: JWT Token 认证
- **会话管理**: Token 存储和自动登录
- **登出处理**: 清理认证信息

### 权限角色

| 角色          | 权限范围   | 可访问系统                     |
| ------------- | ---------- | ------------------------------ |
| **admin**     | 系统管理员 | 营销系统 + 财务系统 + 模板系统 |
| **marketing** | 营销人员   | 营销系统                       |
| **finance**   | 财务人员   | 财务系统                       |
| **developer** | 开发人员   | 模板系统                       |

### 权限控制

- **路由级别**: 基于角色的路由访问控制
- **组件级别**: 细粒度的组件权限验证
- **应用级别**: 微前端应用的访问权限控制

### 路由注册

- 子应用向主应用注册路由信息
- 主应用动态生成导航菜单
- 基于权限控制菜单显示

## 📱 功能模块

### 营销系统路由

```
/marketing
├── /dashboard          # 营销概览
├── /campaigns          # 活动管理
├── /customers          # 客户管理
└── /analytics          # 数据分析
```

### 财务系统路由

```
/finance
├── /dashboard          # 财务概览
├── /reports            # 财务报表
├── /accounts           # 账务管理
└── /cost-analysis      # 成本分析
```

### 模板系统路由

```
/template
├── /dashboard          # 模板概览
├── /feature1           # 功能模块1
├── /feature2           # 功能模块2
└── /settings           # 设置页面
```

### 主应用功能

- **用户欢迎**: 个性化欢迎信息
- **应用入口**: 基于权限的应用卡片
- **快捷导航**: 常用功能快速入口
- **系统状态**: 整体系统运行状态

## 🔧 技术实现

### Module Federation 配置

- **主应用**: shell (3000端口)
  - 远程加载: marketing, finance, template
  - 共享依赖: React, Ant Design
- **子应用**: marketing (3001), finance (3002), template (3003)
  - 暴露组件: ./App
  - 共享依赖: React, Ant Design

### URL 路由设计

```
https://platform.company.com/
├── /login              # 登录页面
├── /dashboard          # 主仪表板
├── /marketing/*        # 营销系统路由
├── /finance/*          # 财务系统路由
└── /template/*         # 模板系统路由
```

### 部署架构

- **独立部署**: 各应用独立构建和部署
- **CDN 支持**: 支持 CDN 部署优化
- **GitHub Pages**: 自动化部署到 GitHub Pages

## 📋 验收标准

### 基础功能

- ✅ 用户登录和权限验证
- ✅ JWT Token 管理和持久化
- ✅ 基于角色的路由守卫
- ✅ 子应用路由注册功能

### 业务功能

- ✅ 营销系统所有页面正常访问
- ✅ 财务系统所有页面正常访问
- ✅ 动态导航菜单正确显示
- ✅ 应用入口卡片基于权限显示

### 技术要求

- ✅ 所有应用支持热更新
- ✅ TypeScript 类型检查通过
- ✅ 应用间状态隔离
- ✅ 构建产物正常生成
- ✅ GitHub Pages 自动部署

### 扩展能力

- ✅ 标准模板支持快速创建新子系统
- ✅ 自动化脚本简化开发流程
- ✅ 统一配置和开发规范

## 🚀 部署要求

- **独立构建**: 各应用独立构建和部署
- **CDN 支持**: 支持 CDN 部署优化
- **自动化部署**: GitHub Actions CI/CD
- **构建优化**: 代码分割、压缩、缓存
