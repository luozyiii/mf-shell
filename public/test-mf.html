<!DOCTYPE html>
<html>
<head>
    <title>Module Federation Test</title>
</head>
<body>
    <h1>Module Federation Test</h1>
    <div id="result"></div>
    
    <script>
        async function testMF() {
            const resultDiv = document.getElementById('result');
            
            try {
                // 首先加载远程入口
                console.log('Loading remote entry...');
                const script = document.createElement('script');
                script.src = 'http://localhost:3003/remoteEntry.js';
                script.onload = async () => {
                    console.log('Remote entry loaded');
                    
                    try {
                        // 等待一下让容器初始化
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                        // 尝试导入模块
                        console.log('Importing template/routes...');
                        const module = await import('template/routes');
                        console.log('Success:', module);
                        resultDiv.innerHTML = '<p style="color: green;">Success: ' + JSON.stringify(Object.keys(module)) + '</p>';
                    } catch (error) {
                        console.error('Import failed:', error);
                        resultDiv.innerHTML = '<p style="color: red;">Import failed: ' + error.message + '</p>';
                    }
                };
                script.onerror = (error) => {
                    console.error('Script load failed:', error);
                    resultDiv.innerHTML = '<p style="color: red;">Script load failed</p>';
                };
                document.head.appendChild(script);
                
            } catch (error) {
                console.error('Test failed:', error);
                resultDiv.innerHTML = '<p style="color: red;">Test failed: ' + error.message + '</p>';
            }
        }
        
        // 页面加载后自动测试
        window.addEventListener('load', testMF);
    </script>
</body>
</html>